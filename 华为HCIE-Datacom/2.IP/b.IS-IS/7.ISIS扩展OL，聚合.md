在 IS-IS 协议中，**路由聚合**和**过载保护（Overload Bit）**是保证大型网络（特别是运营商网络）稳定性和扩展性的两项关键技术。

---

## 一、 IS-IS 路由聚合 (Route Aggregation)

路由聚合（又称路由汇总）的主要目的是减少路由表项的数量，减轻控制平面的压力，并屏蔽局部网络波动对全网的影响。

### 1. 核心原理

IS-IS 的聚合通常在 **Level-1-2 路由器**上执行。当 Level-1 区域的明细路由被引入到 Level-2 区域时，或者在执行外部路由引入（Import-route）时，可以将多条连续的网段汇总成一条大的网段。

### 2. 关键特性

- **减小 LSDB 规模：** 通过聚合，骨干网（Level-2）不需要维护非骨干网（Level-1）的所有明细路由。这符合区域内维护独立 LSDB 的设计原则。
    
- **抑制拓扑震荡：** 如果聚合网段内的一条明细链路发生闪断（Flapping），只要还有其他明细路由在聚合范围内，汇总路由就不会撤回，从而避免了全网 SPF 重新计算。
    
- **黑洞预防：** 配置聚合时，通常会自动产生一条指向 **NULL0** 的本地路由，防止在聚合网段内部存在“地址空洞”时产生环路。
    

---

## 二、 IS-IS 过载保护 (Overload Bit / OL 位)

过载保护是一种特殊的流量引导机制，通过在 LSP（链路状态报文）中设置 **Overload Bit**，告知邻居该设备目前“压力过大”或处于特殊状态。

### 1. 什么是 OL 置位？

当一台 IS-IS 路由器的内存或 CPU 资源不足，或者管理员手动配置了过载状态时，该路由器发出的 LSP 中 Overload 位会被置为 1。

### 2. 对流量转发的影响（重点）

一旦某台路由器设置了 OL 位，其他路由器在进行 **SPF 无环计算** 时会采取以下逻辑：

- **可达性：** 邻居依然可以计算出到达该过载路由器**直连接口**的路径（可以访问这台设备本身）。
    
- **非中转（Non-Transit）：** 邻居在计算路径时，**不会**将该过载路由器作为中转节点。也就是说，没有任何通过这台设备的穿越流量（Transit Traffic）。
    

### 3. 运营商实际应用场景

- **设备维护/升级：** 在切割或升级设备前，先手动开启过载模式，让流量平滑迁移到备用路径上，实现业务零中断。
    
- **等待 BGP 同步（BGP-IGP 同步）：** 在运营商网络中，IGP（IS-IS）收敛通常比 BGP 快。如果路由器刚启动就加入转发，由于 BGP 路由还没学完，会导致流量进入后被丢弃。
    
    - _策略：_ 配置设备启动后自动进入过载状态（例如持续 600 秒），等待 BGP 路由完全同步后再撤销 OL 位，恢复中转转发。
        

---

## 三、 面试官可能的追问

**追问：如果一台 Level-1-2 路由器设置了 OL 位，会对 Level-1 区域的缺省路由产生什么影响？**

> **标准答案：** 当 Level-1-2 路由器的 OL 位置位后，它将**不再**向 Level-1 区域内下发 **ATT（关联）位**。这意味着 Level-1 区域内的路由器将无法通过该过载路由器生成指向 Level-2 的缺省路由，流量会自动切换到其他正常的 Level-1-2 路由器。

---

### 🎙️ 陶同学，面试备考建议：

亚信科技服务于运营商，运营商网络非常看重**“业务不中断”**。当你解释过载保护时，主动提到**“BGP 与 IGP 同步”**或**“设备平滑下线维护”**，会比单纯解释协议定义让面试官觉得你更有实战经验。

**你想让我针对 BGP 选路属性或 MPLS 的 VPN 标签分配再出几道深度的对比题吗？**