**LDP 默认只为IGP的 32位主机路由分配标签**
**MP-BGP 为私网路由分配标签**
**BGP 通过路由策略，为公网路由分配标签**

VPNv4路由： RD：IPv4：ETR：NH：Lable
标签IPv4 路由： IPv4 ：NH ：Lable
	![](assets/5.跨域VPN-OptionC1/file-20251229152814475.png)
C1方案的注意点：
1. 一个AS内部建立的使BGP邻居关系（unicast）
2. ASBR之间建立EBGP邻居关系（unicast）
3. 不同AS的PE建立MP-EBGP邻居关系（vpnv4）


C1的方案，目的是之间在站点PE之间建立MP-EBGP邻居（VPNv4邻居）
为此需要完成：
	1.在ASBR1上向对端EBGP邻居宣告（network）PE1的环回口路由
	2.针对该路由，使用route-policy 分配标签（BGP-LSP标签），再对邻居使能标签路由转发能力（label-route-capability）
	3.在ASBR2上通过使能标签路由转发能力（label-route-capability）接收该路由；为了使，从ASBR1学习到的邻居能够传递给PE2并且让传递给PE2的路由的下一跳自动变为ASBR2，需要对其传递来的==标签路由==，**重新分配标签，通告给RR**，RR也需要使能标签路由转发的功能。
	4.PE上对RR也需要使能（label-route-capability）接收该路由
	5.完成以上操作，那么两个AS中的PE就可以直接建立EBGP邻居。

PE之间建立EBGP邻居关系：
	1.注意ebgp-max-hop
	2.为了传递vpnv4路由，需要建立vpnv4邻居

注意点1：
在ASBR1上宣告（network）的PE1的路由，EBGP邻居学习到了，但是为什么IBGP邻居没有学习到呢？
	1.不是路由选路优先级的问题
    2.而是因为ASBR1再对ASBR2发来的 标签路由 进行替换的时候，route-policy pe export，默认拒绝了。



### 通过反射器RR建立VPNv4邻居
![](assets/5.跨域VPN-OptionC1/file-20251229173813148.png)





