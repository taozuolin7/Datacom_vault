```
[AR1]dis ip routing-table 172.16.2.2    
可以快速在路由表中筛选出可以到达目标的路由  
数据的访问是一去一回的  
数据发送 和 数据回复时 源目地址是倒换的
```
 
```
静态路由：由管理员手工为设备配置的路由条目  
 [AR1]ip route-static 172.16.2.0 24 Gi 0/0/1 10.1.12.2  
 [AR2]ip route-static 172.16.2.0 24 gi 0/0/1 10.1.24.4   
 [AR2]ip route-static 192.168.1.0 24 10.1.12.1  
 配置静态路由时可以不配置出接口，出接口根据下一跳对应的路由 借鉴出接口  
 以太网链路是广播型链路，所以在配置静态路由时，必须配置下一跳（可以省略出接口）  
 串口链路是P2P链路，所以在配置静态路由时，必须配置出接口（可以省略下一跳）
```
 
```
路由中继（路由迭代、路由递归）：  
通过配置可达的下一跳，实现路由多次找寻可达的下一跳完成通信
```
 
```
[AR1]ip route-static 172.16.1.0 24 10.1.34.4 
```
 
```
路由的下一跳设备不可达，则会导致路由是无法生效的
```
 
```
[AR1]ip route-static 10.1.34.0 24 10.1.13.3 
```
 
```
配置路由递归的优势：  
 1.如果配置了所有设备的路由递归，则全网段都可以通信  
 2.可以从全局视角进行流量转发的路径规划
```
 
```
为了后续动态路由学习打基础的（BGP的路由都是递归的）
```
 
```
负载分担路由：  
去往目标网段，存在多个可达的下一跳，在路由表中就显示为负载分担的路由条目
```
 
```
172.16.2.0/24  Static  60   0   D   10.1.12.2   GigabitEthernet0/0/1  
               Static  60   0  RD   10.1.13.3   GigabitEthernet0/0/2
```
 
```
负载分担：  
  1.基于包的负载分担  
      将每一个报文进行链路的随机分配，多条链路的流量趋于平均  
  2.基于流的负载分担  
      将检测的每一条流量，在链路上随机分配
```
 
```
如果存在多条路由负载分担  
则可能会导致来回路径不一致
```
 
```
如果存在网络故障  
需要排查来回路径经过的所有设备  
（运维难度变大了）
```
 
```
浮动路由：  
***路由表中只存在最优的路由条目  
在负载分担路由的基础上，该路由优先级值来选择最优的路由条目
```
 
```
[AR1]ip route-static 172.16.2.0 24 10.1.12.2 preference \<1-255\>    
     静态路由通过改变优先级值来优选路由条目
```
 
```
[AR1]display ip routing-table protocol static   显示  
协议路由表  
     一张表项为 active  该表项内的路由 会加入到路由表中  
     一张表项为 inactive该表项内的路由 是备份路由，如果路由表中对应路由失效，则该表项内的路由会加入路由表
```
 
```
静态的问题：  
不会自动检测链路，但链路发生故障，容易造成数据访问通信失败  
手工配置，配置量大，繁琐，运维困难
```
 
```
控制平面  
路由表中路由的优选：  
*路由表中存在最优的路由条目  
 例子：静态路由和直连路由 网段相同，则路由表会优选直连路由
```
 
```
 相同网段的路由条目，如果路由优先级值不同的情况下：  
    路由表中会加载路由优先级值最小的路由条目  
   
 相同网段的路由条目，如果路由优先级值相同的情况下：  
    路由表中会加载路由开销值最小的路由条目
```
 
```
 相同网段的路由条目，如果路由优先级值和开销都相同的情况下：  
    路由表中会加载这些相同的路由，形成负载分担路由
```

```
转发平面  
数据访问的路由网段优选：  
  根据最长掩码匹配的规则，掩码越长越优先
```
   

```
路由汇总问题：  
AR5设备配置汇总路由 6.6.6.0/29  
AR6设备配置缺省路由 0.0.0.0/0 ，且存在明细路由（6.6.6.1/32、6.6.6.2/32、6.6.6.3/32）  
如果AR6的明细路由（6.6.6.2/32）失效，则AR5通过汇总路由访问到AR6，AR6通过缺省路由发送给AR5  
如果AR5访问AR6的6.6.6.5/32，则AR5通过汇总路由访问到AR6，AR6通过缺省路由发送给AR5 
```
 
```
问题解决：  
   通过增加黑洞路由，来丢弃产生环路的报文  
   [AR6]ip route-static 6.6.6.0 29 NULL 0  汇总路由时，应尽量将路由汇总为掩码长的路由  
  *在配置静态路由时，只做明细路由的配置
```
 
```
终端如何判断数据是同网段的转发 还是 跨网段的转发？  
1.终端根据自身的地址 和 自身的掩码 与运算 得到网段1  
2.终端根据指定访问的DIP 和 自身的掩码 与运算 得到网段2  
3.将网段1和网段2进行对比  
   1.如果网段相同，则认为是同网段访问  
       不需要网关参与  
   2.如果网段不同，则认为是跨网段访问  
       需要将数据先转发给网关
```
 
![Exported image](Exported%20image%2020251206145559-0.png) ![Exported image](Exported%20image%2020251206145601-1.png)
 
```
路由汇总：将小的网段融合为一个大的网段  
CIDR：无类域间路由  
 通过将网络位转变位主机位，来达到变大网段的目的
```
 
```
一般会将连续的一组网段进行汇总
```
 
```
如果路由网段很多，且不连续，可以使用最大的汇总网段  
默认路由（缺省路由） 0.0.0.0/0  
该路由一般使用在企业出口
```
 
```
但是路由汇总往往伴随着路由环路的存在
```