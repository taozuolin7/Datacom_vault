```
网络层 有 IP协议 是TCP/IP中比较重要的部分
```
 
|
|
```
网络层是提供无连接的网络服务  意味着 网
```
```
络层是不安全、不可靠的。
```
 
```
网络层被称为IP层，除了具有IP协议以外，还具备其他的协议  
（ICMP、ARP、OSPF等等）  
网络层 通过将数据封装IP报头 变为数据包
```

```
IP报头：  
1.version：版本，4bit长度（ipv4 、ipv6）  
2.Header Length：头长度，4bit长度（表明了IP头部的长度 20-40字节）  
3.Type of Service：类别服务，8bit长度（提供了优先调度转发的能力，常用于QoS）  
4.Total Length：总长度，16bit长度（IP头 + 上层数据的长度）
```
 
```
5.Identification：标识，16bit长度 ，指定数据发送者  
6.Flags：标志，3bit长度  
            第一个bit，保留不用  
            第二个bit，DF bit（置1：不可以进行分片  置0：可以进行分片）  
            第三个bit，MF bit（置1：还有分片报文    置0：没有分片报文）  
7.Fragment Offset：片偏移，13bit长度  
         第一个包 偏移量为0  
         第二个包 偏移量为 上一个报文携带的数据长度 + 上一个报文的偏移量  
         第三个包 偏移量为 上一个报文携带的数据长度 + 上一个报文的偏移量
```
 
```
8.TTL：存活时间，8bit长度（防止网络环路），取值范围 0-255  
         将时间单位变为跳数单位  
         报文每转发一次跳数值都减一  
         如果收到的报文TTL值为1，则丢弃该报文不在转发  
9.Protocol：协议，8bit长度（表明上层应用协议）  
         ICMP协议号1 、TCP协议号6、UDP协议号17、OSPF协议号89  
10.Header Checksum：头部校验，16bit长度（检测IP包头的完整性）
```
 
```
11.SIP：32bit长度
```
 
```
12.DIP：32bit长度
```
 
```
13.option：0-40bit不定长度，如果添加的功能长度为13字节  
14.padding：用于补充option字段没有完整4字节的一行，通过0填充
```

![Exported image](Exported%20image%2020251206145538-0.png)

```
数据为什么要进行分片？  
1.网络中在数据传输时规定了大小  
     默认传输的字节为1518  
2.数据包过大就需要分次转发
```
 
```
如果使用ICMP协议传输数据（ping数据）  
则需要 封装的报文长度是 帧长18 包长20 ICMP8  
 所以 1518 - （18+20+8） = 1472   
携带数据的最大长度为1472
```

```
数据接收者对于分片报文应该怎么处理？  
需要进行分片报文的重组
```
 
```
如何进行报文重组？  
通过片偏移进行数据重组
```

```
[AR1]ping -c 1 10.1.12.2  ping测试时只发送一个报文
```
 
```
\<AR1\>ping -s 3000 10.1.12.2   ping测试是指定携带数据的大小
```
 
```
\<AR1\>ping -a 10.1.12.1 10.1.12.2   指定ping测试的源IP地址
```

![Exported image](Exported%20image%2020251206145541-1.png)