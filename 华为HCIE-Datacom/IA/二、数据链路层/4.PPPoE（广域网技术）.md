```
PPPoE：  
如果让以太网链路能够支持 LCP、认证、NCP 协商  
如果先进行PPP的协商在进行以太网链路的传递，是否可以满足单链路多设备的认证（PPPoE）  
PPPoE： PPP over Ethernet  
数据访问时，先进行PPP的封装 在进行 以太网的封装
```

![Exported image](Exported%20image%2020251206144702-0.png)  

```
PPPoE实现了在以太网上提供点到点的连接。￼PPPoE客户端与PPPoE服务器端之间建立PPP会话，封装PPP数据报文，￼为以太网上的主机提供接入服务，实现用户控制和计费，在企业网络与运营商网络中应用广泛。￼￼PPPoE的常见应用场景有家庭用户拨号上网、企业用户拨号上网等。￼
```

![Exported image](Exported%20image%2020251206145004-1.png)  

```
PPPoE报文：
```

![Exported image](Exported%20image%2020251206145107-2.png)

```
￼PPPoE发现阶段：
```

![Exported image](Exported%20image%2020251206145113-3.png)

```
￼PPPoE会话阶段：
```

![Exported image](Exported%20image%2020251206145117-4.png)

```
￼PPPoE会话终结阶段：
```

![Exported image](Exported%20image%2020251206145120-5.png)
  
```
PPPoE客户端配置包括三个步骤：  
第一步配置一个拨号接口：dialer（拨号器）  
dialer-rule命令用于进入Dialer-rule视图，在该视图下，可以通过拨号规则来配置发起PPPoE会话的条件。  
interface dialer number命令用来创建并进入Dialer接口。  
dialer user user-name命令用于配置对端用户名，这个用户名必须与对端服务器上的PPP用户名相同。  
dialer-group group-number命令用来将接口置于一个拨号访问组。  
dialer bundle number命令用来指定Dialer接口使用的Dialer bundle。￼设备通过Dialer bundle将物理接口与拨号接口关联起来。  
[R1]dialer-rule   
[R1-dialer-rule]dialer-rule 1 ip permit  
[R1-dialer-rule]quit  
[R1]interface dialer 1   
[R1-Dialer1] dialer user enterprise  
[R1-Dialer1] dialer-group 1   
[R1-Dialer1] dialer bundle 1  
[R1-Dialer1] ppp chap user enterprise@huawei  
[R1-Dialer1] ppp chap password cipher huawei123  
[R1-Dialer1] ip address ppp-negotiate  
第二步是在接口上将Dialer Bundle和接口绑定：  
pppoe-client dial-bundle-number number命令来实现Dialer Bundle和物理接口的绑定，￼用来指定PPPoE会话对应的Dialer Bundle，￼其中number是与PPPoE会话相对应的Dialer Bundle编号。  
[R1]interface GigabitEthernet 0/0/1   
[R1-GigabitEthernet0/0/1]pppoe-client dial-bundle-number 1   
[R1-GigabitEthernet0/0/1]quit  
第三步配置一条缺省静态路由，该路由允许在路由表中没有相应匹配表项的流量都能通过拨号接口发起PPPoE会话。  
[R1]ip route-static 0.0.0.0  0.0.0.0  dialer 1  
PPPoE服务器端配置：￼1.创建地址池与虚拟模板：  
 [R2]ip pool pool1	#创建地址池，指定分配的IP地址和网关  
 [R2-ip-pool-pool1]network 192.168.1.0 mask 255.255.255.0  
 [R2-ip-pool-pool1]gateway-list 192.168.1.254  
 [R2]interface Virtual-Template 1          #创建虚拟模板接口  
 [R2-Virtual-Template1]ppp authentication-mode chap   
 [R2-Virtual-Template1]ip address 192.168.1.254 255.255.255.0  
 [R2-Virtual-Template1]remote address pool pool1  
2.将物理接口与虚拟模板绑定：  
[R2]interface GigabitEthernet 0/0/0  
[R2-GigabitEthernet0/0/0]pppoe-server bind virtual-template 1  
[R2-GigabitEthernet0/0/0]quit  
3.创建访问用户：  
[R2]aaa 	#添加认证用户信息  
[R2-aaa]local-user enterprise password cipher Huawei@123  
[R2-aaa]local-user enterprise service-type ppp  
interface virtual-template命令用来创建虚拟模板接口，或者进入一个已经创建的虚拟模板接口视图。  
pppoe-server bind命令用来配置PPPoE接入用户上线绑定的虚拟模板接口。
```
 
![Exported image](Exported%20image%2020251206145122-6.png) ![Exported image](Exported%20image%2020251206145325-7.png) ![Exported image](Exported%20image%2020251206145327-8.png) ![Exported image](Exported%20image%2020251206145430-9.png)