# MPLS TE的实现框架
**动态MPLS TE隧道建立的实现过程主要依靠信息发布，路径计算，路径建立和流量转发4大功能组件**
- 在网络中部署MPLS TE，需要配置链路属性和隧道属性，之后MPLS TE自动建立相应的隧道。隧道建立后，需要将流量引入隧道进行流量转发协议报文交互
- 对于静态CR-Lsp来说，由于其是用户手工建立，因此不涉及信息发布和路经计算
![](assets/MPLS%20TE/file-20260202111339721.png)
![](assets/3.MPLS%20TE隧道的实现原理/file-20260203104902657.png)

## 信息发布
**链路状态信息**
- MPLS TE信息的发布基于对现有的IGP协议进行扩展，所以依然会发布IGP本身收集的信息(链路状态信息)，如接口IP地址、链路类型、链路开销等
**TE Mertric**
- 为了增强对TE隧道路径计算的可控性，MPLS TE提供了TE Metric，使得隧道在计算路径时能独立于IGP的路由选路。MPLS TE缺省采用链路的IGP Metric
**带宽信息**
MPLs DS-TE(Differentiated Services TE)是将MPLS TE和MPLs DiffServ相结合的一种提供有效的Qos保证的技术
	 1.MPLs DS-TE将LSP的带宽划分为8个部分，每部分被赋予不同的服务等级。这样一条或一组LsP的相同服务等级的带宽集合称为一个CT(Class Type)。这样就可以将具有相同PHB(Per-Hop Behavior)的流量映射到同一个CT上，并为每个CT单独分配资源
	 2.DS-TE最多支持8个CT，可记为CT0-CT7
- BC(Bandwidth Constraints，约束带宽):根据CT带宽可分为Bco-BC7
- 最大可预留带宽(Maximum Reservable Bandwidth):端口最大预留给Tunnel的带宽
- 在非MPLS DS-TE场景下使用BCO,CTo在建立隧道时预留带宽，为业务提供带宽保护
**管理组**
- MPLS TE可以给不同的链路着上不同的颜色，实现隧道根据链路的颜色进行选路
- 管理组 (Administration Group)
	1.也称链路颜色，用来描述链路的属性。由32个Bit组成，每一位都可以单独表示链路的一个属性，用于管理拥有这些特征的链路，在物理接口下配置
	2.链路管理组需要和隧道亲和属性配合使用来达到控制隧道路径的目的
**亲和属性**
- 亲和属性(Affinity Attributes)是用来描述TE隧道所需链路的32位向量值，与管理组属性类似，在这里可以理解为隧道颜色，在隧道的首节点配置实施(隧道信息，不通过iGP发布)。
- 掩码(Mask)，由32个Bit组成，决定了设备需要检查的链路属性，只有隧道颜色和链路颜色匹配才能进行- 正常的数据转发。实际应用中，就是通过修改掩码来选择链路。
- 在Tunnel进行路径选择时，接口(链路)的管理组属性需匹配其亲和属性才有资格被选择
![](assets/3.MPLS%20TE隧道的实现原理/file-20260203110010804.png)